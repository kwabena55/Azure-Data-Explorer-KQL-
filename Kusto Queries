StormEvents
| limit 1000

// Count rows in the StormEvents Table
StormEvents
| count

// Display selected columns in the StormEvents Table
StormEvents
| project EndTime,EpisodeId

// Filtering
StormEvents
| where EpisodeId > 2560

// Use of Distinct
StormEvents
| distinct State

// Use Distinct Count

StormEvents
| distinct State
| count

// select some columns
StormEvents
| project DamageProperty,DeathsDirect,State,EventId
| limit 10

// Some Alias
StormEvents
| project Damage=DamageProperty,Death=DeathsDirect, Stat=State


// Make some queries case insensitive using the ~ 
StormEvents
| where State =~"mississippi"  // ~ is so cool


// Show table Schema

StormEvents
| getschema 


// Group by: Sum of Damage property by DamageProperty
// Remember summarize is the same as Group by so we need to group by a field and just specify the aggregrate
StormEvents
|limit 10000

StormEvents
| summarize DamageProp=sum(DamageProperty),Crops=sum(DamageCrops) by State


//  Grooup by State and Show the sum of Damage Properties and Eventid
StormEvents
| summarize DamageProp=sum(DamageProperty),Crops=sum(DamageCrops), count_Instances=count() by State

StormEvents
| summarize DamageProp=sum(DamageProperty),Crops=sum(DamageCrops), count_Instances=count() by State
| where count_Instances >=2000 

StormEvents
| summarize DamageProp=sum(DamageProperty),Crops=sum(DamageCrops), count_Instances=count() by State
|where count_Instances <2000

// Calculated Column
StormEvents
| summarize DamageProp=sum(DamageProperty), DamageProp_ratio= sum(DamageProperty)/count() by State


// Group by Date
StormEvents
|summarize DamageProp=sum(DamageProperty), DamageProp_ratio= sum(DamageProperty)/count() by month=monthofyear(StartTime)
| order by month asc 


// Group by Year
StormEvents
|summarize DamageProp=sum(DamageProperty), DamageProp_ratio= sum(DamageProperty)/count() by year=getyear(StartTime)
| order by year 